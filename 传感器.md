# imu内参

**IMU 固有参数**：先用 Allan 方差法估计加速度计和陀螺仪的噪声密度（noise density）和随机游走（bias random walk），并在 `imu.yaml` 中定义这些统计属性，作为优化时的权重和噪声模型。

Allan 方差法是一种基于时域两样本方差的噪声分析工具，最初由 David W. Allan 提出，用于评估信号随平均时间 τ 变化时的稳定性。其核心思想是将连续时间序列分成长度为 τ 的重叠或非重叠簇，计算相邻两簇平均值差的方差：

$$\
sigma^2(\tau) \=\
\frac{1}{2\tau^2\(L - 2m)}
\sum_{k=1}^{L-2m}
\bigl(\theta_{k+2m} -2\theta_{k+m} +\theta_k\bigr)^2
$$

为了保证最后一项 $θk+2m$不越界（即 $k+2m≤L$)，k的最大值就必须是 $L−2m$

通过对 PSD 曲线不同斜率区间进行拟合，就能定量得到 IMU 的 **噪声密度（Noise Density）** 和 **随机游走系数（Random Walk）** 等参数。

### 噪声密度（Noise Density）

<img width="1018" height="398" alt="Screenshot from 2025-08-07 14-17-08" src="https://github.com/user-attachments/assets/a3a480e1-0d30-4723-a8a8-0445515660e1" />

### 随机游走（Rate/Accel Random Walk）
<img width="944" height="274" alt="Screenshot from 2025-08-07 14-16-17" src="https://github.com/user-attachments/assets/cc705f7b-c77d-4341-b333-261e56c855f8" />

# imu 相机外参
优化 **IMU 预积分误差** 和 **相机重投影误差**

1. IMU 预积分误差

场景：你在水平面上直线走了一小段路，IMU 记录了加速度和角速度，经过积分，它“估计”你从时刻 A 移动到了时刻 B，走了 0.5 米。

真实情况：其实你走了 0.45 米。


残差（误差）：
IMU 预测走 0.50 米，真实走 0.45 米，二者相差 0.05 米。

这个 0.05 米就是预积分残差的平移部分。

**测量量-预测量**
测量量（Measurement）是**加速度**积分出来的 v和p,预测量（Prediction）是上一时刻的上一时刻的估计速度 加上传感器的**速度**值。

2. 相机重投影误差的简单例子

场景：相机看同一个棋盘格角点，理论上依据相机位置和参数，这个角点应该投影到图像的像素坐标 (200, 150)。

检测结果：图像处理算法真正找到的角点在 (205, 152)。

残差（误差）：
横向误差：205 − 200 = 5 像素
纵向误差：152 − 150 = 2 像素

换句话说，相机“猜”这个点应该在哪儿，和“真”检测到的点相比，差了多少像素，就是它的重投影误差。
